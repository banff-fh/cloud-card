<?xml version="1.0" encoding="UTF-8"?>
<services xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/services.xsd">
    <description>cloudcard Services</description>
    <vendor></vendor>
    <version>1.0</version>
    

    <service name="activateCloudCard" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="activateCloudCard" auth="true">
        <description>云卡激活-内部服务</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>店家partyId</description></attribute>
        <attribute name="teleNumber" type="String" mode="IN" optional="false"><description>客户手机号码</description></attribute>
        <attribute name="cardCode" type="String" mode="IN" optional="false"><description>卡二维码、条码等唯一标识数据</description></attribute>

        <attribute name="finAccountId" type="String" mode="OUT" optional="false"><description>卡的内金融账户Id</description></attribute>
        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
        <attribute name="cardId" type="String" mode="OUT" optional="false"><description>卡id，卡关联的paymentMethodId</description></attribute>
    </service>
    <service name="rechargeCloudCard" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="rechargeCloudCard" auth="true">
        <description>云卡充值-内部服务--内部调用rechargeCloudCardReceipt 和 rechargeCloudCardDeposit</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>店家partyId</description></attribute>
        <attribute name="cardId" type="String" mode="INOUT" optional="false"><description>卡Id</description></attribute>
        <attribute name="amount" type="BigDecimal" mode="INOUT" optional="false"><description>充值金额</description></attribute>

        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
        <attribute name="actualBalance" type="BigDecimal" mode="OUT" optional="false"><description>可用余额</description></attribute>
	</service>

	<service name="rechargeCloudCardReceipt" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="rechargeCloudCardReceipt" auth="true">
        <description>云卡充值-收用户款-内部服务</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>店家partyId</description></attribute>
        <attribute name="payChannel" type="String" mode="IN" optional="true"><description>付款渠道，aliPay， wxPay，默认cash</description></attribute>

        <!-- cardId cardCode cloudCard 三者任输其一，推荐cardId-->
        <attribute name="cardId" type="String" mode="INOUT" optional="true"><description>卡Id</description></attribute>
        <attribute name="cardCode" type="String" mode="IN" optional="true"><description>卡二维码数据</description></attribute>
        <attribute name="cloudCard" type="GenericValue" mode="IN" optional="true"><description>云卡实体</description></attribute>
        
        <attribute name="amount" type="BigDecimal" mode="INOUT" optional="false"><description>充值金额</description></attribute>

        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
        <attribute name="receiptPaymentId" type="String" mode="OUT" optional="false"><description>收款产生的paymentId</description></attribute>
	</service>

	<service name="rechargeCloudCardDeposit" engine="java"
	            location="com.banfftech.cloudcard.CloudCardServices" invoke="rechargeCloudCardDeposit" auth="true">
        <description>云卡充值-入用户账户-内部服务</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>店家partyId</description></attribute>
        <!-- cardId cardCode cloudCard 三者任输其一，推荐cardId-->
        <attribute name="cardId" type="String" mode="INOUT" optional="true"><description>卡Id</description></attribute>
        <attribute name="cardCode" type="String" mode="IN" optional="true"><description>卡二维码数据</description></attribute>
        <attribute name="cloudCard" type="GenericValue" mode="IN" optional="true"><description>云卡实体</description></attribute>
        
        <attribute name="receiptPaymentId" type="String" mode="IN" optional="false"><description>收款产生的paymentId</description></attribute>
        <attribute name="amount" type="BigDecimal" mode="OUT" optional="false"><description>充值金额</description></attribute>

        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
        <attribute name="actualBalance" type="BigDecimal" mode="OUT" optional="false"><description>可用余额</description></attribute>
	</service>

    <service name="cloudCardWithdraw" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="cloudCardWithdraw" auth="true">
        <description>云卡付款-内部服务</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>商家partyId</description></attribute>
        <attribute name="cardId" type="String" mode="IN" optional="true"><description>卡ID</description></attribute>
        <attribute name="cardCode" type="String" mode="IN" optional="true"><description>卡二维码数据</description></attribute>
        <attribute name="cloudCard" type="GenericValue" mode="IN" optional="true"><description>云卡实体</description></attribute>
        <attribute name="amount" type="BigDecimal" mode="INOUT" optional="false"><description>支付金额</description></attribute>
        
        <attribute name="cardId" type="String" mode="OUT" optional="true"><description>卡Id</description></attribute>
        <attribute name="cardBalance" type="BigDecimal" mode="OUT" optional="false"><description>可用余额</description></attribute>
        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
    </service>

	<service name="createPaymentAndFinAccountTransForCloudCard" engine="simple"
            location="component://cloudcard/script/com/banfftech/cloudcard/CloudCardServices.xml" invoke="createPaymentAndFinAccountTransForCloudCard" auth="true">
        <description> create new payment and associate with respective financial account in FinAccountTrans Entity,
        Notice: Only CloudCard use, 
        base on : component://accounting/script/org/ofbiz/accounting/finaccount/FinAccountServices.xml#createPaymentAndFinAccountTrans
        </description>
        <implements service="createPayment"/>
        <attribute name="finAccountId" type="String" mode="IN" optional="true"/>
        <attribute name="finAccountTransTypeId" type="String" mode="IN" optional="false"/>
        <attribute name="reasonEnumId" type="String" mode="IN" optional="true"/>
        <attribute name="paymentMethodId" type="String" mode="IN" optional="true"/>
        <attribute name="paymentId" type="String" mode="OUT" optional="true"/>
    </service>
    
    <service name="getLoginCaptcha" engine="java"
		location="com.banfftech.cloudcard.sms.SmsServices" invoke="getLoginCaptcha" auth="false">
		<description>获取登录验证码</description>
        <attribute name="teleNumber" type="String" mode="IN" optional="false"/>
	</service>

	<service name="genNewCloudCardCode" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="genNewCloudCardCode" auth="true">
		<description>生成云卡卡号</description>
		<attribute name="organizationPartyId" type="String" mode="IN" optional="false"/>
        <attribute name="finAccountName" type="String" mode="IN" optional="false"/>
        <attribute name="currencyUomId" type="String" mode="IN" optional="false"/>
        <attribute name="quantity" type="String" mode="IN" optional="false"/>
        <attribute name="result" type="String" mode="OUT" optional="true"/>
	</service>
	
	<service name="checkAppVersion" engine="java"
		location="com.banfftech.cloudcard.CloudCardQueryServices" invoke="checkAppVersion" auth="false">
		<description>检查app版本号</description>
		<attribute name="curVersion" type="String" mode="IN" optional="false"><description>当前版本号</description></attribute>
        <attribute name="deviceType" type="String" mode="IN" optional="false"><description>设备类型</description></attribute>
        <attribute name="appType" type="String" mode="IN" optional="false"><description>app类型</description></attribute>
        <attribute name="latestVersion" type="String" mode="OUT" optional="false"><description>最新版本号</description></attribute>
        <attribute name="updateType" type="Integer" mode="OUT" optional="false"><description>是否强制更新</description></attribute>
        <attribute name="url" type="String" mode="OUT" optional="true"><description>app更新地址</description></attribute>
	</service>
	
	
	
	<service name="doSettlement" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="doSettlement" auth="true">
		<description>商家结算</description>
		<attribute name="partyId" type="String" mode="INOUT" optional="false"><description>商家partyId</description></attribute>
		<attribute name="arAmount" type="BigDecimal" mode="OUT" optional="true"><description>平台应从商家收取金额</description></attribute>
		<attribute name="apAmount" type="BigDecimal" mode="OUT" optional="true"><description>平台应付给商家金额</description></attribute>
		<attribute name="settlementAmount" type="BigDecimal" mode="OUT" optional="true"><description>结算余额</description></attribute>
	</service>
	
	<service name="regJpushRegId" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="regJpushRegId" auth="true">
		<description>注册设备regId</description>
		<attribute name="regId" type="String" mode="IN" optional="true"><description>设备Id</description></attribute>
		<attribute name="deviceType" type="String" mode="IN" optional="true"><description>设备类型</description></attribute>
		<attribute name="appType" type="String" mode="IN" optional="true"><description>用户app类型</description></attribute>
	</service>
	
	<service name="removeJpushRegId" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="removeJpushRegId" auth="true">
		<description>退出登录删除regId</description>
		<attribute name="regId" type="String" mode="IN" optional="true"><description>设备Id</description></attribute>
	</service>
	
	
	<service name="pushNotifOrMessage" engine="java"
		location="com.banfftech.cloudcard.jpush.JPushServices" invoke="pushNotifOrMessage" auth="true">
		<description>极光推送通知或（和）消息</description>
		<attribute name="appType" type="String" mode="IN" optional="false"><description>app类型 biz user</description></attribute>
		<attribute name="sendType" type="String" mode="IN" optional="true"><description>类型 all 全部用户、one 单个partyId、tag 单个tag标签</description></attribute>
		<attribute name="content" type="String" mode="IN" optional="true"><description>通知内容</description></attribute>
		<attribute name="title" type="String" mode="IN" optional="true"><description>通知title</description></attribute>
		<attribute name="message" type="String" mode="IN" optional="true"><description>透传消息</description></attribute>
		<attribute name="partyId" type="String" mode="IN" optional="true"><description>发送到哪个用户</description></attribute>
		<attribute name="tag" type="String" mode="IN" optional="true"><description>发送到那个标签</description></attribute>
		<attribute name="extras" type="Map" mode="IN" optional="true"><description>推送的extrasMap</description></attribute>
	
		<attribute name="cardId" type="String" mode="IN" optional="true"><description>卡Id</description></attribute>
		<attribute name="amount" type="BigDecimal" mode="IN" optional="true"><description>金额</description></attribute>
		<attribute name="cardBalance" type="BigDecimal" mode="IN" optional="true"><description>余额</description></attribute>
	</service>

	<service name="uniformOrder" engine="java"
		location="com.banfftech.cloudcard.pay.PayServices" invoke="uniformOrder" auth="true">
		<description>支付宝或微信统一下单</description>
		<!-- 公共参数 -->
		<attribute name="paymentType" type="String" mode="IN" optional="false"><description>支付方式</description></attribute>
		<attribute name="cardId" type="String" mode="IN" optional="false"><description>卡Id</description></attribute>
		<attribute name="body" type="String" mode="IN" optional="false"><description>商品描述</description></attribute>
		<attribute name="totalFee" type="String" mode="IN" optional="false"><description>交易金额</description></attribute>
		<attribute name="paymentService" type="String" mode="IN" optional="false"><description>付款业务</description></attribute>
		
		<!-- 支付宝参数 -->
		<attribute name="subject" type="String" mode="IN" optional="true"><description>主题</description></attribute>
		<!--微信参数-->
		<attribute name="tradeType" type="String" mode="IN" optional="true"><description>交易类型</description></attribute>

		<!-- 微信返回结果 -->
		<attribute name="appid" type="String" mode="OUT" optional="true"><description>商户ID</description></attribute>
		<attribute name="partnerid" type="String" mode="OUT" optional="true"><description>合作ID</description></attribute>
		<attribute name="prepayid" type="String" mode="OUT" optional="true"><description>预付ID</description></attribute>
		<attribute name="package" type="String" mode="OUT" optional="true"><description>报名</description></attribute>
		<attribute name="noncestr" type="String" mode="OUT" optional="true"><description>随机数</description></attribute>
		<attribute name="timestamp" type="String" mode="OUT" optional="true"><description>时间</description></attribute>
		<attribute name="sign" type="String" mode="OUT" optional="true"><description>签名</description></attribute>
		<!-- 支付宝返回结果 -->
		<attribute name="payInfo" type="String" mode="OUT" optional="true"><description>签名</description></attribute>
		
	</service>

    <service name="orderPayQuery" engine="java"
		location="com.banfftech.cloudcard.pay.PayServices" invoke="orderPayQuery" auth="true">
		<description>支付宝或微信查询服务</description>
		<!-- 公共参数 -->
		<attribute name="paymentType" type="String" mode="IN" optional="false"><description>支付类型</description></attribute>
		<attribute name="transactionId" type="String" mode="IN" optional="true"><description>第三方交易流水ID</description></attribute>
		<attribute name="outTradeNo" type="String" mode="IN" optional="false"><description>商家交易流水ID</description></attribute>
	
		<attribute name="cashFee" type="Double" mode="OUT" optional="true"><description>支付金额</description></attribute>
		<attribute name="returnCode" type="String" mode="OUT" optional="true"><description>返回状态码</description></attribute>
		<attribute name="returnMsg" type="String" mode="OUT" optional="true"><description>返回信息</description></attribute>
		<attribute name="tradeType" type="String" mode="OUT" optional="true"><description>交易类型</description></attribute>
		<attribute name="outTradeNo" type="String" mode="OUT" optional="true"><description>商户订单号</description></attribute>
		<attribute name="tradeNo" type="String" mode="OUT" optional="true"><description>第三方订单号</description></attribute>
		<attribute name="timeEnd" type="String" mode="OUT" optional="true"><description>支付完成时间</description></attribute>
		<attribute name="tradeState" type="String" mode="OUT" optional="true"><description>交易状态</description></attribute>
	</service>
	
	<service name="editGeoLocation" engine="simple"
		location="component://party/script/org/ofbiz/party/party/PartySimpleEvents.xml" invoke="editGeoLocation" auth="true">
		<description>支付宝或微信查询服务</description>
		<!-- 公共参数 -->
		<attribute name="lat" type="String" mode="IN" optional="false"><description>纬度</description></attribute>
		<attribute name="lng" type="String" mode="IN" optional="false"><description>经度</description></attribute>
		<attribute name="partyId" type="String" mode="IN" optional="false"><description>商家交易流水ID</description></attribute>
	</service>

	<service name="addUserScore" engine="java"
		location="com.banfftech.cloudcard.util.CloudCardLevelScoreUtil" invoke="addUserScore" auth="true">
		<description>内部服务-增加用户积分</description>
		<attribute name="amount" type="BigDecimal" mode="IN" optional="false"><description>要增加的积分数</description></attribute>
		<attribute name="partyId" type="String" mode="IN" optional="false"><description>给哪个用户增加</description></attribute>
	</service>
	
	<service name="getProvinceOrCityOrArea" engine="java"
        invoke="getProvinceOrCityOrArea" location="com.banfftech.cloudcard.CloudCardServices" auth="false">
        <description>获取省市县</description>
        <attribute name="geoAssocTypeId" mode="IN" type="String"/>
        <attribute name="provinceId" mode="IN" type="String" optional="true"/>
        <attribute name="cityId" mode="IN" type="String" optional="true"/>

        <attribute name="provinceList" mode="OUT" type="List" optional="true"/>
        <attribute name="cityList" mode="OUT" type="List" optional="true"/>
        <attribute name="countyList" mode="OUT" type="List" optional="true"/>
    </service>
    
    <service name="upload" engine="java"
        invoke="uploadOSS" location="com.banfftech.cloudcard.util.UtilFileUpload" auth="false">
        <description>获取用户上传的文件，并传到阿里云OSS存储</description>
		<attribute mode="IN" name="uploadedFile" type="java.nio.ByteBuffer" optional="false"><description>文件流</description></attribute>
		<attribute mode="IN" name="_uploadedFile_fileName" type="String" optional="false"><description>文件名</description></attribute>
		<attribute mode="IN" name="_uploadedFile_contentType" type="String" optional="false"><description>文件mime类型</description></attribute>
		<attribute mode="OUT" name="key" type="String" optional="false"><description>文件key</description></attribute>
    </service>
    
    <service name="saveMyNote" engine="java"
        invoke="saveMyNote" location="com.banfftech.cloudcard.CloudCardHelper" auth="false">
        <description>记录app推送消息</description>
        <attribute mode="IN" name="partyId" type="String" optional="false"><description>partyId</description></attribute>
		<attribute mode="IN" name="noteName" type="String" optional="false"><description>信息名称</description></attribute>
		<attribute mode="IN" name="noteInfo" type="String" optional="false"><description>信息</description></attribute>
    </service>
    
    <service name="delFile" engine="java"
        invoke="delFile" location="com.banfftech.cloudcard.util.UtilFileUpload" auth="false">
        <description>在阿里云OSS存储中删除上传的文件</description>
		<attribute mode="IN" name="key" type="String" optional="false"><description>文件key</description></attribute>
    </service>


    <service name="getAssociatedGeoList" engine="java"
        invoke="getAssociatedGeoList" location="com.banfftech.cloudcard.CloudCardGeoServices" auth="true">
        <description>获取下级地理信息</description>
		<attribute mode="IN" name="geoIdFrom" type="String" optional="false"><description>父级GeoId</description></attribute>
		<attribute mode="IN" name="geoAssocTypeId" type="String" optional="true"><description>Geo级联类型</description></attribute>
		<attribute mode="IN" name="listOrderBy" type="String" optional="true"><description>排序字段</description></attribute>
		<attribute mode="OUT" name="geoList" type="List" optional="true"><description>返回的下级Geo列表</description></attribute>
    </service>
    
    <service name="bizSettlementReqJob" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="bizSettlementReqJob" auth="false">
            <description>结算定时任务请求</description>
    </service>
</services>