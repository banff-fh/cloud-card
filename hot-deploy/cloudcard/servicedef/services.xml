<?xml version="1.0" encoding="UTF-8"?>
<services xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/services.xsd">
    <description>cloudcard Services</description>
    <vendor></vendor>
    <version>1.0</version>
    

    <service name="activateCloudCard" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="activateCloudCard" auth="true">
        <description>云卡激活-内部服务</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>店家partyId</description></attribute>
        <attribute name="teleNumber" type="String" mode="IN" optional="false"><description>客户手机号码</description></attribute>
        <attribute name="cardCode" type="String" mode="IN" optional="false"><description>卡二维码、条码等唯一标识数据</description></attribute>

        <attribute name="finAccountId" type="String" mode="OUT" optional="false"><description>卡Id</description></attribute>
        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
        <attribute name="paymentMethodId" type="String" mode="OUT" optional="false"><description>卡关联的paymentMethodId</description></attribute>
    </service>
    <service name="rechargeCloudCard" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="rechargeCloudCard" auth="true">
        <description>云卡充值-内部服务</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>店家partyId</description></attribute>
        <attribute name="cardId" type="String" mode="INOUT" optional="false"><description>卡Id</description></attribute>
        <attribute name="amount" type="BigDecimal" mode="INOUT" optional="false"><description>充值金额</description></attribute>

        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
        <attribute name="actualBalance" type="BigDecimal" mode="OUT" optional="false"><description>可用余额</description></attribute>
	</service>

    <service name="cloudCardWithdraw" engine="java"
            location="com.banfftech.cloudcard.CloudCardServices" invoke="cloudCardWithdraw" auth="true">
        <description>云卡付款-内部服务</description>
        <attribute name="organizationPartyId" type="String" mode="IN" optional="false"><description>商家partyId</description></attribute>
        <attribute name="cardId" type="String" mode="IN" optional="true"><description>卡ID</description></attribute>
        <attribute name="cardCode" type="String" mode="IN" optional="true"><description>卡二维码数据</description></attribute>
        <attribute name="cloudCard" type="GenericValue" mode="IN" optional="true"><description>云卡实体</description></attribute>
        <attribute name="amount" type="BigDecimal" mode="INOUT" optional="false"><description>支付金额</description></attribute>
        
        <attribute name="cardId" type="String" mode="OUT" optional="true"><description>卡Id</description></attribute>
        <attribute name="cardBalance" type="BigDecimal" mode="OUT" optional="false"><description>可用余额</description></attribute>
        <attribute name="customerPartyId" type="String" mode="OUT" optional="false"><description>客户partyId</description></attribute>
    </service>

	<service name="createPaymentAndFinAccountTransForCloudCard" engine="simple"
            location="component://cloudcard/script/com/banfftech/cloudcard/CloudCardServices.xml" invoke="createPaymentAndFinAccountTransForCloudCard" auth="true">
        <description> create new payment and associate with respective financial account in FinAccountTrans Entity,
        Notice: Only CloudCard use, 
        base on : component://accounting/script/org/ofbiz/accounting/finaccount/FinAccountServices.xml#createPaymentAndFinAccountTrans
        </description>
        <implements service="createPayment"/>
        <attribute name="finAccountId" type="String" mode="IN" optional="true"/>
        <attribute name="finAccountTransTypeId" type="String" mode="IN" optional="false"/>
        <attribute name="reasonEnumId" type="String" mode="IN" optional="true"/>
        <attribute name="paymentMethodId" type="String" mode="IN" optional="true"/>
        <attribute name="paymentId" type="String" mode="OUT" optional="true"/>
    </service>
    
    <service name="getLoginCaptcha" engine="java"
		location="com.banfftech.cloudcard.sms.SmsServices" invoke="getLoginCaptcha" auth="false">
		<description>获取登录验证码</description>
        <attribute name="teleNumber" type="String" mode="IN" optional="false"/>
	</service>

	<service name="genNewCloudCardCode" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="genNewCloudCardCode" auth="true">
		<description>生成云卡卡号</description>
		<attribute name="organizationPartyId" type="String" mode="IN" optional="false"/>
        <attribute name="finAccountName" type="String" mode="IN" optional="false"/>
        <attribute name="currencyUomId" type="String" mode="IN" optional="false"/>
        <attribute name="quantity" type="String" mode="IN" optional="false"/>
        <attribute name="result" type="String" mode="OUT" optional="true"/>
	</service>
	
	<service name="checkAppVersion" engine="java"
		location="com.banfftech.cloudcard.CloudCardQueryServices" invoke="checkAppVersion" auth="false">
		<description>检查app版本号</description>
		<attribute name="curVersion" type="String" mode="IN" optional="false"><description>当前版本号</description></attribute>
        <attribute name="deviceType" type="String" mode="IN" optional="false"><description>设备类型</description></attribute>
        <attribute name="appType" type="String" mode="IN" optional="false"><description>app类型</description></attribute>
        <attribute name="latestVersion" type="String" mode="OUT" optional="false"><description>最新版本号</description></attribute>
        <attribute name="updateType" type="Integer" mode="OUT" optional="false"><description>是否强制更新</description></attribute>
        <attribute name="url" type="String" mode="OUT" optional="true"><description>app更新地址</description></attribute>
	</service>
	
	
	
	<service name="doSettlement" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="doSettlement" auth="true">
		<description>商家结算</description>
		<attribute name="partyId" type="String" mode="INOUT" optional="false"><description>商家partyId</description></attribute>
		<attribute name="arAmount" type="BigDecimal" mode="OUT" optional="true"><description>平台应从商家收取金额</description></attribute>
		<attribute name="apAmount" type="BigDecimal" mode="OUT" optional="true"><description>平台应付给商家金额</description></attribute>
		<attribute name="settlementAmount" type="BigDecimal" mode="OUT" optional="true"><description>结算余额</description></attribute>
	</service>
	
	<service name="regJpushRegId" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="regJpushRegId" auth="true">
		<description>注册设备regId</description>
		<attribute name="regId" type="String" mode="IN" optional="true"><description>设备Id</description></attribute>
		<attribute name="deviceType" type="String" mode="IN" optional="true"><description>设备类型</description></attribute>
		<attribute name="appType" type="String" mode="IN" optional="true"><description>用户app类型</description></attribute>
	</service>
	
	<service name="removeJpushRegId" engine="java"
		location="com.banfftech.cloudcard.CloudCardServices" invoke="removeJpushRegId" auth="true">
		<description>退出登录删除regId</description>
		<attribute name="regId" type="String" mode="IN" optional="true"><description>设备Id</description></attribute>
	</service>
	
	
	<service name="pushNotifOrMessage" engine="java"
		location="com.banfftech.cloudcard.jpush.JPushServices" invoke="pushNotifOrMessage" auth="true">
		<description>极光推送通知或（和）消息</description>
		<attribute name="appType" type="String" mode="IN" optional="false"><description>app类型 biz user</description></attribute>
		<attribute name="sendType" type="String" mode="IN" optional="true"><description>类型 all 全部用户、one 单个partyId、tag 单个tag标签</description></attribute>
		<attribute name="content" type="String" mode="IN" optional="true"><description>通知内容</description></attribute>
		<attribute name="title" type="String" mode="IN" optional="true"><description>通知title</description></attribute>
		<attribute name="message" type="String" mode="IN" optional="true"><description>透传消息</description></attribute>
		<attribute name="partyId" type="String" mode="IN" optional="true"><description>发送到哪个用户</description></attribute>
		<attribute name="tag" type="String" mode="IN" optional="true"><description>发送到那个标签</description></attribute>
		<attribute name="extras" type="Map" mode="IN" optional="true"><description>推送的extrasMap</description></attribute>
	
		<attribute name="cardId" type="String" mode="IN" optional="true"><description>卡Id</description></attribute>
		<attribute name="amount" type="BigDecimal" mode="IN" optional="true"><description>金额</description></attribute>
		<attribute name="cardBalance" type="BigDecimal" mode="IN" optional="true"><description>余额</description></attribute>
	</service>

	<service name="uniformOrder" engine="java"
		location="com.banfftech.cloudcard.pay.PayServices" invoke="uniformOrder" auth="true">
		<description>支付宝或微信统一下单</description>
		<!-- 公共参数 -->
		<attribute name="paymentType" type="String" mode="IN" optional="false"><description>卡Id</description></attribute>
		<attribute name="cardId" type="String" mode="IN" optional="false"><description>卡Id</description></attribute>
		<attribute name="body" type="String" mode="IN" optional="false"><description>商品描述</description></attribute>
		<attribute name="totalFee" type="String" mode="IN" optional="false"><description>交易金额</description></attribute>
		<!-- 支付宝参数 -->
		<attribute name="subject" type="String" mode="IN" optional="true"><description>主题</description></attribute>
		<!--微信参数-->
		<attribute name="tradeType" type="String" mode="IN" optional="true"><description>交易类型</description></attribute>

		<!-- 微信返回结果 -->
		<attribute name="appid" type="String" mode="OUT" optional="true"><description>商户ID</description></attribute>
		<attribute name="partnerid" type="String" mode="OUT" optional="true"><description>合作ID</description></attribute>
		<attribute name="prepayid" type="String" mode="OUT" optional="true"><description>预付ID</description></attribute>
		<attribute name="package" type="String" mode="OUT" optional="true"><description>报名</description></attribute>
		<attribute name="noncestr" type="String" mode="OUT" optional="true"><description>随机数</description></attribute>
		<attribute name="timestamp" type="String" mode="OUT" optional="true"><description>时间</description></attribute>
		<attribute name="sign" type="String" mode="OUT" optional="true"><description>签名</description></attribute>
		<!-- 支付宝返回结果 -->
		<attribute name="payInfo" type="String" mode="OUT" optional="true"><description>签名</description></attribute>
		
	</service>

    <service name="orderPayQuery" engine="java"
		location="com.banfftech.cloudcard.pay.PayServices" invoke="orderPayQuery" auth="true">
		<description>支付宝或微信查询服务</description>
		<!-- 公共参数 -->
		<attribute name="paymentType" type="String" mode="IN" optional="false"><description>支付类型</description></attribute>
		<attribute name="transactionId" type="String" mode="IN" optional="false"><description>第三方交易流水ID</description></attribute>
		<attribute name="outTradeNo" type="String" mode="IN" optional="true"><description>商家交易流水ID</description></attribute>

		<!-- 微信返回结果 -->
		<attribute name="cashFee" type="Double" mode="OUT" optional="true"><description>现金支付金额</description></attribute>
		<attribute name="returnCode" type="String" mode="OUT" optional="true"><description>返回状态码</description></attribute>
		<attribute name="returnMsg" type="String" mode="OUT" optional="true"><description>返回信息</description></attribute>
		<attribute name="tradeType" type="String" mode="OUT" optional="true"><description>交易类型</description></attribute>
		<attribute name="outTradeNo" type="String" mode="OUT" optional="true"><description>商户订单号</description></attribute>
		<attribute name="timeEnd" type="String" mode="OUT" optional="true"><description>支付完成时间</description></attribute>
		<attribute name="tradeState" type="String" mode="OUT" optional="true"><description>交易状态</description></attribute>
		<attribute name="tradeStateDesc" type="String" mode="OUT" optional="true"><description>交易状态描述</description></attribute>
				
		<!-- 支付宝返回结果 -->
		<attribute name="payInfo" type="String" mode="OUT" optional="true"><description>签名</description></attribute>
		
	</service>

</services>